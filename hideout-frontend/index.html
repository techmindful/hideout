<html>

  <head>
    <meta charset="UTF-8">
    <title>Technical Mindfulness</title>
    <script src="/main.js"></script>
  </head>

  <body>

    <div id="elm-app"></div>
    <script>
      var elmApp = Elm.Main.init({
        node: document.getElementById("elm-app")
      })

      var socket = new WebSocket( "ws://localhost:8080/chat" );
      elmApp.ports.sendMessage.subscribe( function( message )
          {
            socket.send( message );
          } );
      socket.addEventListener( "message", function( event )
        {
          elmApp.ports.messageReceiver.send( event.data );
        } );

      window.addEventListener( "beforeunload", function( event )
        {
          socket.close();
        } ); 
    </script>

  </body>

</html>

